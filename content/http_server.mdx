---
title: "Building a Basic HTTP Server with Node.js"
publishedAt: "2024-12-30"
summary: "In this blog we will create an HTTP Server from Scratch"
---

Hey anon ðŸ‘‹ Welcome to my blog!

In the last blog, we dived into **Reverse Proxies** and also created one ourselves! So, in this blog, we'll be building something much simpler than that. We will be building a very basic HTTP Server with **Node.js**, specifically a **HTTP/0.9** Server.

**HTTP/0.9** was the first version of the HTTP Protocol released back in 1991. **HTTP/0.9** was an extremely simple protocol, with very basic functionality. Unlike modern HTTP versions, there were no headers, no status codes like **404 Not Found**, and no complex request methods like **POST**, **PUT** OR **DELETE**.

A typical **HTTP/0.9** request would simply be:

```bash
GET /index.html
```

And the server would respond with the raw HTML file, without any extra metadata. Something like this:

```bash
<!DOCTYPE html>
<html lang="en">
<head>
    <title>Greetings</title>
</head>
<body>
    <h1>Hello!</h1>
</body>
</html>
```

---

### It's BUILD Time!

#### Step 1: Prerequisites

First, ensure you have **Node.js** and **npm** installed on your system. If not, you can download them from [nodejs.org](https://nodejs.org).

#### Step 2: Set Up Your Project

Next, create a directory, `cd` into it and initialize a node project:

```bash
mkdir http-server
cd http-server
npm init -y
```

For this project, we don't need any external dependencies since we will be utilizing the built-in net and fs modules that come with Node.js.

---

#### 1. Importing the required modules.

We are importing the net module for creating a TCP server and the fs/promises module to interact with the file system asynchronously.

```javascript
import * as net from "net";
import * as fs from "fs/promises";
```

#### 2. Creating the TCP Server

```javascript
const server = net.createServer();
const htmlFilePath = "./html/";
```

- The first line creates a TCP server, which listens for incoming connections.
- The second line sets the path to the directory where our server will look for HTML files. This also serves as a security measure, preventing clients from accessing files outside of the designated directory, such as system files or sensitive documents. For example, a request like:

```bash
GET ../../documents
```

would be blocked, as the server is restricted to the defined HTML file path.

#### 3. Handling Server Events

```typescript
server.on("connection", handleNewConnection);
server.on("error", (err: Error) => {
  console.log(err);
});
```

- The first line listens for new client connections. Whenever a client connects to the server, the `handleNewConnection` function is triggered to handle the interaction, such as processing requests and sending responses.
- The second line listens for any errors that occur during the server's operation. If an error is thrown, it will be caught here, and logged.

#### 4. Writing the `handleNewConnection` function

The function takes the `socket` object as a parameter, which is automatically passed to it whenever a new client connection is established, triggering the function. This `socket` object represents the communication channel between the server and the connected client, allowing us to read data from and send responses to the client.

```typescript
function handleNewConnection(socket: net.Socket) {
  console.log("New Connection!");

  socket.on("data", async (data: Buffer) => {
    const request = new TextDecoder().decode(data);
    const splitRequest = request.split(" ");
    let htmlFile;

    if (splitRequest.length !== 2) {
      socket.write("Error: Incomplete Request");
      socket.end();
      return;
    }

    const requestType = splitRequest[0];

    if (splitRequest[1].trim() === "/") {
      htmlFile = "index.html";
    } else {
      htmlFile = splitRequest[1].slice(1);
    }

    if (requestType !== "GET") {
      socket.write("Error: Only GET Requests are supported!");
      socket.end();
      return;
    }

    try {
      const filePath = htmlFilePath + htmlFile;
      const fileData = await fs.readFile(filePath);
      socket.write(fileData);
    } catch (err) {
      socket.write("Error: Requested resource does not exist!");
    }

    socket.end();
  });

  socket.on("end", () => {
    console.log("Connection closed!");
  });
}
```

Let's go through the function step-by-step.

#### 1. New Connection

logs **"New Connection!"**, whenever a new client connects to the server.
